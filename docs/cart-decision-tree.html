<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 CART (Decision Tree) | R algorithm notes</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 CART (Decision Tree) | R algorithm notes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 CART (Decision Tree) | R algorithm notes" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Yao-Chung" />


<meta name="date" content="2021-12-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="knn-k-nearest-neighbors.html"/>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a></li>
<li class="chapter" data-level="2" data-path="ab-test.html"><a href="ab-test.html"><i class="fa fa-check"></i><b>2</b> A/B test</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ab-test.html"><a href="ab-test.html#scenario"><i class="fa fa-check"></i><b>2.1</b> Scenario</a></li>
<li class="chapter" data-level="2.2" data-path="ab-test.html"><a href="ab-test.html#case-study"><i class="fa fa-check"></i><b>2.2</b> Case study</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="k-means.html"><a href="k-means.html"><i class="fa fa-check"></i><b>3</b> K-means</a></li>
<li class="chapter" data-level="4" data-path="knn-k-nearest-neighbors.html"><a href="knn-k-nearest-neighbors.html"><i class="fa fa-check"></i><b>4</b> kNN (k-Nearest Neighbors)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="knn-k-nearest-neighbors.html"><a href="knn-k-nearest-neighbors.html#difference-calculating-the-distance-1-euclidean-2-manhatten-3-cosine-4-jaccard-coefficient-5-minkowski"><i class="fa fa-check"></i><b>4.1</b> Difference calculating the distance: (1) Euclidean (2) Manhatten (3) Cosine (4) Jaccard Coefficient (5) MinKowski</a></li>
<li class="chapter" data-level="4.2" data-path="knn-k-nearest-neighbors.html"><a href="knn-k-nearest-neighbors.html#find-the-k-nearest-neighbors"><i class="fa fa-check"></i><b>4.2</b> Find the k nearest neighbors</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="cart-decision-tree.html"><a href="cart-decision-tree.html"><i class="fa fa-check"></i><b>5</b> CART (Decision Tree)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="cart-decision-tree.html"><a href="cart-decision-tree.html#classification-tree"><i class="fa fa-check"></i><b>5.1</b> Classification Tree</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R algorithm notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cart-decision-tree" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> CART (Decision Tree)</h1>
<p>2021-12-22 updated<br />
Ref: <a href="https://www.r-bloggers.com/2021/04/decision-trees-in-r/">here</a><br />
Decision Tree can handle classification and regression problem. It is also called CART (Classification and Regression Tree). In the following, we will use spam data and Boston house pricing data to demonstrate.</p>
<div id="classification-tree" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Classification Tree</h2>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="cart-decision-tree.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG) <span class="co"># data sets used in examples and exercise</span></span>
<span id="cb61-2"><a href="cart-decision-tree.html#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(party) <span class="co"># for recursive partitioning</span></span>
<span id="cb61-3"><a href="cart-decision-tree.html#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart) <span class="co"># recursive partitioning and regression trees</span></span>
<span id="cb61-4"><a href="cart-decision-tree.html#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot) <span class="co"># plot rpart models</span></span>
<span id="cb61-5"><a href="cart-decision-tree.html#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mlbench) <span class="co"># collection of ML benchmark problems</span></span>
<span id="cb61-6"><a href="cart-decision-tree.html#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret) <span class="co"># Misc functions for training/plotting models</span></span>
<span id="cb61-7"><a href="cart-decision-tree.html#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb61-8"><a href="cart-decision-tree.html#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tree) <span class="co"># classification and regression tree</span></span></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="cart-decision-tree.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting Email spam data</span></span>
<span id="cb62-2"><a href="cart-decision-tree.html#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(spam7)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    4601 obs. of  7 variables:
##  $ crl.tot: num  278 1028 2259 191 191 ...
##  $ dollar : num  0 0.18 0.184 0 0 0 0.054 0 0.203 0.081 ...
##  $ bang   : num  0.778 0.372 0.276 0.137 0.135 0 0.164 0 0.181 0.244 ...
##  $ money  : num  0 0.43 0.06 0 0 0 0 0 0.15 0 ...
##  $ n000   : num  0 0.43 1.16 0 0 0 0 0 0 0.19 ...
##  $ make   : num  0 0.21 0.06 0 0 0 0 0 0.15 0.06 ...
##  $ yesno  : Factor w/ 2 levels &quot;n&quot;,&quot;y&quot;: 2 2 2 2 2 2 2 2 2 2 ...</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="cart-decision-tree.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data partition</span></span>
<span id="cb64-2"><a href="cart-decision-tree.html#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb64-3"><a href="cart-decision-tree.html#cb64-3" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> spam7</span>
<span id="cb64-4"><a href="cart-decision-tree.html#cb64-4" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">2</span>, <span class="fu">nrow</span>(mydata), <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>)) <span class="co"># assign index</span></span>
<span id="cb64-5"><a href="cart-decision-tree.html#cb64-5" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> mydata[ind <span class="sc">==</span> <span class="dv">1</span>,]</span>
<span id="cb64-6"><a href="cart-decision-tree.html#cb64-6" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> mydata[ind <span class="sc">==</span> <span class="dv">2</span>,]</span>
<span id="cb64-7"><a href="cart-decision-tree.html#cb64-7" aria-hidden="true" tabindex="-1"></a>tree <span class="ot">&lt;-</span> <span class="fu">rpart</span>(yesno <span class="sc">~</span> ., <span class="at">data=</span>train)</span>
<span id="cb64-8"><a href="cart-decision-tree.html#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(tree)</span></code></pre></div>
<p><img src="R-Algorithm-Notes_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="cart-decision-tree.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">printcp</span>(tree)</span></code></pre></div>
<pre><code>## 
## Classification tree:
## rpart(formula = yesno ~ ., data = train)
## 
## Variables actually used in tree construction:
## [1] bang    crl.tot dollar 
## 
## Root node error: 900/2305 = 0.39046
## 
## n= 2305 
## 
##         CP nsplit rel error  xerror     xstd
## 1 0.474444      0   1.00000 1.00000 0.026024
## 2 0.074444      1   0.52556 0.56556 0.022128
## 3 0.010000      3   0.37667 0.42111 0.019773</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="cart-decision-tree.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotcp</span>(tree)</span></code></pre></div>
<p><img src="R-Algorithm-Notes_files/figure-html/unnamed-chunk-26-2.png" width="672" /></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="cart-decision-tree.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print confusion matrix of your model on training dataset</span></span>
<span id="cb68-2"><a href="cart-decision-tree.html#cb68-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">predict</span>(tree, train, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb68-3"><a href="cart-decision-tree.html#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(p, train<span class="sc">$</span>yesno, <span class="at">positive=</span><span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    n    y
##          n 1278  212
##          y  127  688
##                                           
##                Accuracy : 0.8529          
##                  95% CI : (0.8378, 0.8671)
##     No Information Rate : 0.6095          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.6857          
##                                           
##  Mcnemar&#39;s Test P-Value : 5.061e-06       
##                                           
##             Sensitivity : 0.7644          
##             Specificity : 0.9096          
##          Pos Pred Value : 0.8442          
##          Neg Pred Value : 0.8577          
##              Prevalence : 0.3905          
##          Detection Rate : 0.2985          
##    Detection Prevalence : 0.3536          
##       Balanced Accuracy : 0.8370          
##                                           
##        &#39;Positive&#39; Class : y               
## </code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="cart-decision-tree.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ROC curve</span></span>
<span id="cb70-2"><a href="cart-decision-tree.html#cb70-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(tree, test, <span class="at">type=</span><span class="st">&quot;prob&quot;</span>)</span>
<span id="cb70-3"><a href="cart-decision-tree.html#cb70-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p1[,<span class="dv">2</span>] <span class="co"># extract y information</span></span>
<span id="cb70-4"><a href="cart-decision-tree.html#cb70-4" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">multiclass.roc</span>(test<span class="sc">$</span>yesno, p1, <span class="at">percent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb70-5"><a href="cart-decision-tree.html#cb70-5" aria-hidden="true" tabindex="-1"></a>roc <span class="ot">&lt;-</span> r[[<span class="st">&quot;rocs&quot;</span>]]</span>
<span id="cb70-6"><a href="cart-decision-tree.html#cb70-6" aria-hidden="true" tabindex="-1"></a>r1 <span class="ot">&lt;-</span> roc[[<span class="dv">1</span>]]</span>
<span id="cb70-7"><a href="cart-decision-tree.html#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.roc</span>(</span>
<span id="cb70-8"><a href="cart-decision-tree.html#cb70-8" aria-hidden="true" tabindex="-1"></a>    r1,</span>
<span id="cb70-9"><a href="cart-decision-tree.html#cb70-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">print.auc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb70-10"><a href="cart-decision-tree.html#cb70-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">auc.polygon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb70-11"><a href="cart-decision-tree.html#cb70-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>),</span>
<span id="cb70-12"><a href="cart-decision-tree.html#cb70-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid.col =</span> <span class="fu">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>),</span>
<span id="cb70-13"><a href="cart-decision-tree.html#cb70-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">max.auc.polygon =</span> <span class="cn">TRUE</span>,</span>
<span id="cb70-14"><a href="cart-decision-tree.html#cb70-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">auc.polygon.col =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb70-15"><a href="cart-decision-tree.html#cb70-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">print.thres =</span> <span class="cn">TRUE</span>,</span>
<span id="cb70-16"><a href="cart-decision-tree.html#cb70-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;ROC Curve&quot;</span></span>
<span id="cb70-17"><a href="cart-decision-tree.html#cb70-17" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="R-Algorithm-Notes_files/figure-html/unnamed-chunk-28-1.png" width="672" />
## Regression Tree</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="cart-decision-tree.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;BostonHousing&quot;</span>)</span>
<span id="cb71-2"><a href="cart-decision-tree.html#cb71-2" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> BostonHousing</span>
<span id="cb71-3"><a href="cart-decision-tree.html#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mydata)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    506 obs. of  14 variables:
##  $ crim   : num  0.00632 0.02731 0.02729 0.03237 0.06905 ...
##  $ zn     : num  18 0 0 0 0 0 12.5 12.5 12.5 12.5 ...
##  $ indus  : num  2.31 7.07 7.07 2.18 2.18 2.18 7.87 7.87 7.87 7.87 ...
##  $ chas   : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ nox    : num  0.538 0.469 0.469 0.458 0.458 0.458 0.524 0.524 0.524 0.524 ...
##  $ rm     : num  6.58 6.42 7.18 7 7.15 ...
##  $ age    : num  65.2 78.9 61.1 45.8 54.2 58.7 66.6 96.1 100 85.9 ...
##  $ dis    : num  4.09 4.97 4.97 6.06 6.06 ...
##  $ rad    : num  1 2 2 3 3 3 5 5 5 5 ...
##  $ tax    : num  296 242 242 222 222 222 311 311 311 311 ...
##  $ ptratio: num  15.3 17.8 17.8 18.7 18.7 18.7 15.2 15.2 15.2 15.2 ...
##  $ b      : num  397 397 393 395 397 ...
##  $ lstat  : num  4.98 9.14 4.03 2.94 5.33 ...
##  $ medv   : num  24 21.6 34.7 33.4 36.2 28.7 22.9 27.1 16.5 18.9 ...</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="cart-decision-tree.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data partition</span></span>
<span id="cb73-2"><a href="cart-decision-tree.html#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb73-3"><a href="cart-decision-tree.html#cb73-3" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">2</span>, <span class="fu">nrow</span>(mydata), <span class="at">replace =</span> T, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb73-4"><a href="cart-decision-tree.html#cb73-4" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> mydata[ind <span class="sc">==</span> <span class="dv">1</span>,]</span>
<span id="cb73-5"><a href="cart-decision-tree.html#cb73-5" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> mydata[ind <span class="sc">==</span> <span class="dv">2</span>,]</span>
<span id="cb73-6"><a href="cart-decision-tree.html#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="cart-decision-tree.html#cb73-7" aria-hidden="true" tabindex="-1"></a>tree <span class="ot">&lt;-</span> <span class="fu">rpart</span>(medv <span class="sc">~</span>., <span class="at">data =</span> train)</span>
<span id="cb73-8"><a href="cart-decision-tree.html#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(tree)</span></code></pre></div>
<p><img src="R-Algorithm-Notes_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="cart-decision-tree.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">printcp</span>(tree)</span></code></pre></div>
<pre><code>## 
## Regression tree:
## rpart(formula = medv ~ ., data = train)
## 
## Variables actually used in tree construction:
## [1] age   crim  lstat rm   
## 
## Root node error: 22620/262 = 86.334
## 
## n= 262 
## 
##         CP nsplit rel error  xerror     xstd
## 1 0.469231      0   1.00000 1.01139 0.115186
## 2 0.128700      1   0.53077 0.62346 0.080154
## 3 0.098630      2   0.40207 0.51042 0.076055
## 4 0.033799      3   0.30344 0.42674 0.069827
## 5 0.028885      4   0.26964 0.39232 0.066342
## 6 0.028018      5   0.24075 0.37848 0.066389
## 7 0.015141      6   0.21274 0.34877 0.065824
## 8 0.010000      7   0.19760 0.33707 0.065641</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="cart-decision-tree.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotcp</span>(tree)</span></code></pre></div>
<p><img src="R-Algorithm-Notes_files/figure-html/unnamed-chunk-30-2.png" width="672" /></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="cart-decision-tree.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predict</span></span>
<span id="cb77-2"><a href="cart-decision-tree.html#cb77-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">predict</span>(tree, train)</span>
<span id="cb77-3"><a href="cart-decision-tree.html#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="cart-decision-tree.html#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co"># RMSE</span></span>
<span id="cb77-5"><a href="cart-decision-tree.html#cb77-5" aria-hidden="true" tabindex="-1"></a>(<span class="fu">sqrt</span>(<span class="fu">mean</span>((train<span class="sc">$</span>medv <span class="sc">-</span> p)<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## [1] 4.130294</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="cart-decision-tree.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R squared</span></span>
<span id="cb79-2"><a href="cart-decision-tree.html#cb79-2" aria-hidden="true" tabindex="-1"></a>(<span class="fu">cor</span>(train<span class="sc">$</span>medv, p))<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 0.8024039</code></pre>
<p>In the regression model, the r square value is 80% and RMSE is 4.13, not bad at all.. In this way, you can make use of Decision classification regression tree models.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="knn-k-nearest-neighbors.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/04-cart.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["R Algorithm Notes.pdf", "R Algorithm Notes.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
